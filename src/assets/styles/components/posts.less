//---------------------- Controls ----------------------//

//@post-image-width: 260px; // Height fixed to 16:9 ratio

@post-image-border-radius: 5px;

//"small-circular-thumbnail" class in "styles.less" used for user image

.post {
    margin: 0 10px 20px 10px;
    //width: 100%;
    padding: 20px 6px;
    background-color: white;
    box-shadow: 0 1px 10px 0 rgba(10,8,72,.08);
    border-radius: 10px;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    //align-items: center;
    z-index: 8;
    animation: fade-in 0.6s ease;

    @media screen and (max-width: 700px) {
        padding: 14px 6px;
    }
}

    .post-index {
        width: 30px;
        //height: 220px;
        //background-color: @light-grey-2;
        display: flex;
        flex-direction: row;
        justify-content: flex-start;
        align-items: center;
        flex-shrink: 0;

        @media screen and (max-width: 700px) {
            display: none;
        }
    }

        .post-index-content {
            width: 30px;
            height: 30px;
        }

            .post-index-content-padding {
                width: 30px;
                height: 30px;
                display: flex;
                flex-direction: row;
                align-items: center;
            }

                .post-index-text {
                    color: #ddd;
                    font-size: @small-text;
                    font-weight: @regular-font-weight;
                    margin: auto;
                }

    .post-body {
        width: 100%;
        height: 100%;
        margin: 0 10px;
        //background-color: @light-grey-1;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        //align-items: center;
    }

        .post-tags {
            //width: 100%;
            //height: @small-circular-thumbnail;
            margin-bottom: 10px;
            //background-color: @light-grey-2;
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: center;
            flex-shrink: 0;
            flex-wrap: wrap;
        }

            .post-date {
                display: flex;
                flex-direction: row;
                justify-content: flex-start;
                align-items: center;
                flex-shrink: 0;
            }

                .post-type-marker {
                    width: 10px;
                    height: 10px;
                    border-radius: 5px;
                    flex-shrink: 0;
                
                    &.style--audio { background-color: @post-type-audio; }
                    &.style--image { background-color: @post-type-image; }
                    &.style--page { background-color: @post-type-page; }
                    &.style--poll { background-color: @post-type-poll; }
                    &.style--text { background-color: @post-type-text; }
                    &.style--video { background-color: @post-type-video; }
                }

        .post-content {
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            //align-items: center;
            flex-wrap: nowrap;

            @media screen and (max-width: 700px) {
                flex-wrap: wrap;
            }
        }

            .post-image-container {
                width: 260px;
                flex-shrink: 0;
                margin-right: 10px;

                @media screen and (max-width: 700px) {
                    width: 100%;
                }
            }
            
                .post-image {
                    position: relative;
                    width: 100%;
                    padding-top: 56.25%;
                    border-radius: @post-image-border-radius;
                    background-position: center; 
                    background-size: cover;
                    display: flex;
                    flex-shrink: 0;
                
                    &:hover {
                        box-shadow: 0 2px 10px rgba(140, 144, 155, 0.25);
                        background-position: center; 
                        background-size: cover;
                        display: flex;
                        flex-shrink: 0;
                    }
                }

            .member {
                width: 48px;
                height: 48px;
                //background-image: linear-gradient(141deg, #9fb8ad 0%, #1fc8db 51%, #2cb5e8 75%);
                background-color: @brand-blue; //rgb(185, 217, 255);
                display: flex;
                flex-direction: row;
                justify-content: flex-start;
                border-radius: 50%;
                margin-right: 6px;
                opacity: 0.8;
                flex-shrink: 0;
            }

            .post-info {
                //width: 100%;
                height: 100%;
                //margin-left: 10px;
                //background-color: @light-grey-5;
                display: flex;
                flex-direction: column;
                justify-content: flex-start;
                //align-items: center;
                overflow: hidden;
            }

                .post-title {
                    width: 100%;
                    //height: @large-text;
                    margin-bottom: 4px;
                    padding-right: 10px;
                    //background-color: @light-grey-3;
                    //display: flex;
                    //flex-direction: column;
                    //justify-content: flex-start;
                    //align-items: center;
                    @media screen and (max-width: 700px) {
                        margin-top: 10px;
                    }
                    
                }

                .post-description {
                    width: 100%;
                    //max-height: 80px;
                    padding-right: 10px;
                    overflow: hidden;
                    //margin-bottom: 2px;
                    //display: flex;
                    //flex-direction: column;
                    //justify-content: flex-start;
                    //align-items: center;
                }

                .post-interact {
                    //width: 100%;
                    //height: 30px;
                    //background-color: @light-grey-3;
                    display: flex;
                    flex-direction: row;
                    justify-content: flex-start;
                    align-items: center;
                    flex-wrap: wrap;
                }

                    .post-interact-section {
                        display: flex;
                        flex-direction: row;
                        justify-content: flex-start;
                        align-items: center;
                        margin-top: 10px;
                    }

                        .post-interact-icon {
                            width: 16px;
                            height: 16px;
                            //fill: #FE939B;
                            opacity: 0.2;
                            background-position: center; 
                            background-size: cover;
                            cursor: pointer;
                        
                            &:hover {
                                opacity: 0.4;
                            }

                            svg {
                                height: 16px;
                                width: auto;
                            
                                path { transition: fill .2s; }
                              }

                            &:not(:disabled) {
                            &.style--active {
                                opacity: 1;
                        
                                path { fill: #FE939B; } //Light red: #FE939B, light blue: #9fc3e7//
                            }
                        
                            &:hover { opacity: .6; }
                            }
                        
                            &:disabled {
                            cursor: initial;
                            opacity: .1;
                            }
                        
                            &:focus { outline: none; }
                        }
                        

//---------------------- Pinned Posts ----------------------//

.pinned-post {
    //background-color: @light-grey-0; // rgb(242, 249, 255);
    border-radius: 10px;
    padding: 12px 0;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    box-shadow: 0 0 14px #ddd; // inset
    //flex-shrink: 0;
    //align-items: center;
    //z-index: 8;
}

.post-tags-with-pin {
    //width: 100%;
    height: @small-circular-thumbnail;
    margin-bottom: 10px;
    //background-color: @light-grey-2;
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    //align-items: center;
    flex-shrink: 0;
}

.pinned-post-icon {
    width: 20px;
    height: 20px;
}

//---------------------- Post Preview ----------------------//

@post__preview-control-btn-size: 26px;
@post__preview-control-btn-opacity: .5;

@post__preview-control-btn-animation-speed: .3s;
@post__preview-control-btn-animation-easing: ease;
@post__preview-control-btn-animation-start-opacity: @post__preview-control-btn-opacity;
@post__preview-control-btn-animation-start-transform: scale(1);
@post__preview-control-btn-animation-end-opacity: 0;
@post__preview-control-btn-animation-end-transform: scale(0);

@post__preview-content-animation-start-opacity: 1;
@post__preview-content-animation-start-transform: translateY(0);
@post__preview-content-animation-end-opacity: 0;
@post__preview-content-animation-end-transform: translateY(-100%);

.post__preview {
    //border-bottom: solid 1px @light-grey;
    min-height: @post__preview-control-btn-size + (@g-padding-post * 2);
    overflow: hidden;
    position: relative;

    ng-include {
      display: block;
      height: 100%;
      margin: @g-padding-post;
      overflow: hidden;
      // Must be padding so the content animation goes to the top edge.
      padding-top: 0;
      position: relative;
    }
  }

  .post__preview-content {
    transition: all @post__preview-control-btn-animation-speed @post__preview-control-btn-animation-easing;

    p { margin: 10px;
        font-size: @font-size-sm; }

    &.ng-hide-add {
      opacity: @post__preview-content-animation-start-opacity;
      transform: @post__preview-content-animation-start-transform;

      &.ng-hide-add-active {
        opacity: @post__preview-content-animation-end-opacity;
        transform: @post__preview-content-animation-end-transform;
      }
    }

    &.ng-hide-remove {
      opacity: @post__preview-content-animation-end-opacity;
      transform: @post__preview-content-animation-end-transform;

      &.ng-hide-remove-active {
        opacity: @post__preview-content-animation-start-opacity;
        transform: @post__preview-content-animation-start-transform;
      }
    }

    &.style--image {
      text-align: center;

      &.maximised .post__preview-image-container {
        height: 350px;
        width: auto;
      }
    }

    &.style--video {
      margin-left: auto;
      margin-right: auto;
      width: 100%;

      div {
        height: 0;
        position: relative;
        padding-bottom: 56.25%; /* 16:9 */
        padding-top: 25px;
        transition: width .3s ease-out;

        iframe {
          height: 100%;
          left: 0;
          position: absolute;
          top: 0;
          width: 100%;
        }
      }

      &.maximised { width: 100%; }

      .mediaQuery(@screen-md, { width: 43.75%; });
    }
  }

  .post__preview-controls {
    position: absolute;
    right: @g-padding-post;
    top: @g-padding-post;
    z-index: 1;

    .post__preview-control-btn {
      height: @post__preview-control-btn-size;
      opacity: @post__preview-control-btn-opacity;
      width: @post__preview-control-btn-size;
      transition: transform @post__preview-control-btn-animation-speed @post__preview-control-btn-animation-easing;
      // Fix Webkit blur issue.
      // @source: https://stackoverflow.com/questions/27060690/webkit-transform-scale-blurry-images
      -webkit-filter: blur(0px);

      &:not(:last-child) { margin-right: 8px; }

      &:hover {
        cursor: pointer;
        opacity: 1;
      }

      &.toggled { transform: rotateZ(180deg); }

      &.ng-hide-add,
      &.ng-hide-remove {
        transition: transform @post__preview-control-btn-animation-speed @post__preview-control-btn-animation-easing,
          opacity @post__preview-control-btn-animation-speed @post__preview-control-btn-animation-easing;
      }

      &.ng-hide-add {
        opacity: @post__preview-control-btn-animation-start-opacity;
        transform: @post__preview-control-btn-animation-start-transform;

        &.ng-hide-add-active {
          opacity: @post__preview-control-btn-animation-end-opacity;
          transform: @post__preview-control-btn-animation-end-transform;
        }
      }

      &.ng-hide-remove {
        opacity: @post__preview-control-btn-animation-end-opacity;
        transform: @post__preview-control-btn-animation-end-transform;

        &.ng-hide-remove-active {
          opacity: @post__preview-control-btn-animation-start-opacity;
          transform: @post__preview-control-btn-animation-start-transform;
        }
      }
    }
  }

  .post__preview-image {
    // fallback for older browsers
    background-position: center center;
    background-repeat: no-repeat;
    background-size: cover;
    height: inherit;
    width: inherit;
  }

  // Has fallback for not loading the image.
  .post__preview-image-container {
    @size: 200px;
    background-image: url('/assets/images/invalid-image-url.jpg');
    // fallback for older browsers
    background-position: center center;
    background-repeat: no-repeat;
    background-size: cover;
    // ensure it wraps correctly around the image, even if it is a a or span tag
    display: inline-block;
    height: @size;
    // min-height: 100px;
    min-width: @size;
    width: auto;
    transition: height .3s ease-out;
  }

  .post__content-wrapper {
    flex: 1;
    overflow-y: auto;

    .list-item__title { line-height: 1.5 !important; }

    .style--card-poll-answer {
      .list-item(70px);

      // 10px padding for poll answers as they used to go to the edge in cases
      // with very long strings.
      .list-item-info {
        padding-bottom: 10px;
        padding-top: 10px;
      }
    }
  }

  .post__content-header {
    // Overwrites .header
    align-items: center !important;
    border-bottom: 1px solid @light-grey;
    display: flex !important;
    justify-content: flex-start !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    padding: @g-padding-post !important;
  }

  .post__scrollable-view {
    flex: 1;
    overflow-y: auto;
  }

  .mediaQuery(@screen-md, {
    .loading-container {
      height: calc(~'100% - 20px');
      width: calc(~'100% - 20px');
    }
  });

  #no-answers {
    font-style: italic;
    padding-left: 15px;
  }